{"ast":null,"code":"var _jsxFileName = \"/Users/chaitra/Desktop/EduTrack/frontend/src/components/VideoPlayer.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef } from 'react';\nimport './VideoPlayer.css';\n\n// Extract YouTube video ID from various URL formats\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst extractVideoId = videoIdOrUrl => {\n  if (!videoIdOrUrl) return null;\n\n  // If it's already an 11-character ID, return it\n  if (videoIdOrUrl.length === 11 && /^[a-zA-Z0-9_-]{11}$/.test(videoIdOrUrl)) {\n    return videoIdOrUrl;\n  }\n\n  // Try to extract from YouTube URL\n  const patterns = [/(?:youtube\\.com\\/watch\\?v=|youtu\\.be\\/|youtube\\.com\\/embed\\/)([a-zA-Z0-9_-]{11})/, /youtube\\.com\\/.*[?&]v=([a-zA-Z0-9_-]{11})/];\n  for (const pattern of patterns) {\n    const match = videoIdOrUrl.match(pattern);\n    if (match && match[1]) {\n      return match[1];\n    }\n  }\n  return null;\n};\nconst VideoPlayer = ({\n  videoId,\n  videoUrl,\n  onVideoEnd,\n  courseId,\n  videoId: videoDbId,\n  onProgressUpdate,\n  onVideoStart\n}) => {\n  _s();\n  const iframeRef = useRef(null);\n  const progressIntervalRef = useRef(null);\n  const lastProgressTimeRef = useRef(0);\n\n  // Use videoUrl if provided, otherwise use videoId\n  const source = videoUrl || videoId;\n  const extractedId = extractVideoId(source);\n  useEffect(() => {\n    let player = null;\n    let progressCheckInterval = null;\n\n    // Load YouTube IFrame API\n    if (!window.YT) {\n      const tag = document.createElement('script');\n      tag.src = 'https://www.youtube.com/iframe_api';\n      const firstScriptTag = document.getElementsByTagName('script')[0];\n      firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);\n    }\n\n    // Wait for API to load\n    const initPlayer = () => {\n      if (window.YT && window.YT.Player && extractedId) {\n        player = new window.YT.Player(iframeRef.current, {\n          videoId: extractedId,\n          events: {\n            onStateChange: event => {\n              // 0 = ended, 1 = playing, 2 = paused\n              if (event.data === 0 && onVideoEnd) {\n                onVideoEnd();\n              }\n\n              // Start tracking progress when playing\n              if (event.data === 1 && courseId && videoDbId && onProgressUpdate) {\n                progressCheckInterval = setInterval(() => {\n                  if (player && player.getCurrentTime) {\n                    try {\n                      const currentTime = Math.floor(player.getCurrentTime());\n                      if (currentTime > lastProgressTimeRef.current) {\n                        lastProgressTimeRef.current = currentTime;\n                        onProgressUpdate(courseId, videoDbId, currentTime);\n                      }\n                    } catch (e) {\n                      // Ignore errors\n                    }\n                  }\n                }, 5000); // Check every 5 seconds\n              } else if (event.data === 2 || event.data === 0) {\n                // Paused or ended - clear interval\n                if (progressCheckInterval) {\n                  clearInterval(progressCheckInterval);\n                  progressCheckInterval = null;\n                }\n              }\n            },\n            onReady: () => {\n              // Player is ready\n            }\n          }\n        });\n      }\n    };\n    if (window.YT && window.YT.Player) {\n      initPlayer();\n    } else {\n      window.onYouTubeIframeAPIReady = initPlayer;\n    }\n\n    // Listen for YouTube player events via postMessage\n    const handleMessage = event => {\n      if (event.origin !== 'https://www.youtube.com') return;\n      try {\n        const data = JSON.parse(event.data);\n        if (data.event === 'onStateChange') {\n          // 0 = ended, 1 = playing, 2 = paused\n          if (data.info === 0 && onVideoEnd) {\n            onVideoEnd();\n          }\n        }\n      } catch (e) {\n        // Ignore parse errors\n      }\n    };\n    window.addEventListener('message', handleMessage);\n    return () => {\n      window.removeEventListener('message', handleMessage);\n      if (progressCheckInterval) {\n        clearInterval(progressCheckInterval);\n      }\n      if (progressIntervalRef.current) {\n        clearInterval(progressIntervalRef.current);\n      }\n    };\n  }, [extractedId, onVideoEnd, courseId, videoDbId, onProgressUpdate]);\n  if (!extractedId) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"video-player-error\",\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Invalid video URL. Please check the video link.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 17\n      }, this), source && /*#__PURE__*/_jsxDEV(\"p\", {\n        style: {\n          fontSize: '0.9rem',\n          marginTop: '0.5rem',\n          color: '#666'\n        },\n        children: [\"Original URL: \", source]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 13\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"video-player-wrapper\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"video-player-container\",\n      children: /*#__PURE__*/_jsxDEV(\"iframe\", {\n        ref: iframeRef,\n        className: \"video-iframe\",\n        src: `https://www.youtube.com/embed/${extractedId}?rel=0&modestbranding=1&enablejsapi=1&origin=${window.location.origin}`,\n        title: \"YouTube video player\",\n        frameBorder: \"0\",\n        allow: \"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\",\n        allowFullScreen: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 143,\n    columnNumber: 9\n  }, this);\n};\n_s(VideoPlayer, \"s/tR3EkEHZnRyf+DNrewMT6kBI0=\");\n_c = VideoPlayer;\nexport default VideoPlayer;\nvar _c;\n$RefreshReg$(_c, \"VideoPlayer\");","map":{"version":3,"names":["React","useEffect","useRef","jsxDEV","_jsxDEV","extractVideoId","videoIdOrUrl","length","test","patterns","pattern","match","VideoPlayer","videoId","videoUrl","onVideoEnd","courseId","videoDbId","onProgressUpdate","onVideoStart","_s","iframeRef","progressIntervalRef","lastProgressTimeRef","source","extractedId","player","progressCheckInterval","window","YT","tag","document","createElement","src","firstScriptTag","getElementsByTagName","parentNode","insertBefore","initPlayer","Player","current","events","onStateChange","event","data","setInterval","getCurrentTime","currentTime","Math","floor","e","clearInterval","onReady","onYouTubeIframeAPIReady","handleMessage","origin","JSON","parse","info","addEventListener","removeEventListener","className","children","fileName","_jsxFileName","lineNumber","columnNumber","style","fontSize","marginTop","color","ref","location","title","frameBorder","allow","allowFullScreen","_c","$RefreshReg$"],"sources":["/Users/chaitra/Desktop/EduTrack/frontend/src/components/VideoPlayer.js"],"sourcesContent":["import React, { useEffect, useRef } from 'react';\nimport './VideoPlayer.css';\n\n// Extract YouTube video ID from various URL formats\nconst extractVideoId = (videoIdOrUrl) => {\n    if (!videoIdOrUrl) return null;\n    \n    // If it's already an 11-character ID, return it\n    if (videoIdOrUrl.length === 11 && /^[a-zA-Z0-9_-]{11}$/.test(videoIdOrUrl)) {\n        return videoIdOrUrl;\n    }\n    \n    // Try to extract from YouTube URL\n    const patterns = [\n        /(?:youtube\\.com\\/watch\\?v=|youtu\\.be\\/|youtube\\.com\\/embed\\/)([a-zA-Z0-9_-]{11})/,\n        /youtube\\.com\\/.*[?&]v=([a-zA-Z0-9_-]{11})/,\n    ];\n    \n    for (const pattern of patterns) {\n        const match = videoIdOrUrl.match(pattern);\n        if (match && match[1]) {\n            return match[1];\n        }\n    }\n    \n    return null;\n};\n\nconst VideoPlayer = ({ videoId, videoUrl, onVideoEnd, courseId, videoId: videoDbId, onProgressUpdate, onVideoStart }) => {\n    const iframeRef = useRef(null);\n    const progressIntervalRef = useRef(null);\n    const lastProgressTimeRef = useRef(0);\n    \n    // Use videoUrl if provided, otherwise use videoId\n    const source = videoUrl || videoId;\n    const extractedId = extractVideoId(source);\n    \n    useEffect(() => {\n        let player = null;\n        let progressCheckInterval = null;\n        \n        // Load YouTube IFrame API\n        if (!window.YT) {\n            const tag = document.createElement('script');\n            tag.src = 'https://www.youtube.com/iframe_api';\n            const firstScriptTag = document.getElementsByTagName('script')[0];\n            firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);\n        }\n        \n        // Wait for API to load\n        const initPlayer = () => {\n            if (window.YT && window.YT.Player && extractedId) {\n                player = new window.YT.Player(iframeRef.current, {\n                    videoId: extractedId,\n                    events: {\n                        onStateChange: (event) => {\n                            // 0 = ended, 1 = playing, 2 = paused\n                            if (event.data === 0 && onVideoEnd) {\n                                onVideoEnd();\n                            }\n                            \n                            // Start tracking progress when playing\n                            if (event.data === 1 && courseId && videoDbId && onProgressUpdate) {\n                                progressCheckInterval = setInterval(() => {\n                                    if (player && player.getCurrentTime) {\n                                        try {\n                                            const currentTime = Math.floor(player.getCurrentTime());\n                                            if (currentTime > lastProgressTimeRef.current) {\n                                                lastProgressTimeRef.current = currentTime;\n                                                onProgressUpdate(courseId, videoDbId, currentTime);\n                                            }\n                                        } catch (e) {\n                                            // Ignore errors\n                                        }\n                                    }\n                                }, 5000); // Check every 5 seconds\n                            } else if (event.data === 2 || event.data === 0) {\n                                // Paused or ended - clear interval\n                                if (progressCheckInterval) {\n                                    clearInterval(progressCheckInterval);\n                                    progressCheckInterval = null;\n                                }\n                            }\n                        },\n                        onReady: () => {\n                            // Player is ready\n                        }\n                    }\n                });\n            }\n        };\n        \n        if (window.YT && window.YT.Player) {\n            initPlayer();\n        } else {\n            window.onYouTubeIframeAPIReady = initPlayer;\n        }\n        \n        // Listen for YouTube player events via postMessage\n        const handleMessage = (event) => {\n            if (event.origin !== 'https://www.youtube.com') return;\n            \n            try {\n                const data = JSON.parse(event.data);\n                if (data.event === 'onStateChange') {\n                    // 0 = ended, 1 = playing, 2 = paused\n                    if (data.info === 0 && onVideoEnd) {\n                        onVideoEnd();\n                    }\n                }\n            } catch (e) {\n                // Ignore parse errors\n            }\n        };\n        \n        window.addEventListener('message', handleMessage);\n        \n        return () => {\n            window.removeEventListener('message', handleMessage);\n            if (progressCheckInterval) {\n                clearInterval(progressCheckInterval);\n            }\n            if (progressIntervalRef.current) {\n                clearInterval(progressIntervalRef.current);\n            }\n        };\n    }, [extractedId, onVideoEnd, courseId, videoDbId, onProgressUpdate]);\n    \n    if (!extractedId) {\n        return (\n            <div className=\"video-player-error\">\n                <p>Invalid video URL. Please check the video link.</p>\n                {source && (\n                    <p style={{ fontSize: '0.9rem', marginTop: '0.5rem', color: '#666' }}>\n                        Original URL: {source}\n                    </p>\n                )}\n            </div>\n        );\n    }\n\n    return (\n        <div className=\"video-player-wrapper\">\n            <div className=\"video-player-container\">\n                <iframe\n                    ref={iframeRef}\n                    className=\"video-iframe\"\n                    src={`https://www.youtube.com/embed/${extractedId}?rel=0&modestbranding=1&enablejsapi=1&origin=${window.location.origin}`}\n                    title=\"YouTube video player\"\n                    frameBorder=\"0\"\n                    allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\"\n                    allowFullScreen\n                ></iframe>\n            </div>\n        </div>\n    );\n};\n\nexport default VideoPlayer;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
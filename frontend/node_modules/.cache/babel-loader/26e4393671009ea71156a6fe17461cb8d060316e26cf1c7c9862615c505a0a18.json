{"ast":null,"code":"import React,{useEffect,useRef}from'react';import'./VideoPlayer.css';// Extract YouTube video ID from various URL formats\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const extractVideoId=videoIdOrUrl=>{if(!videoIdOrUrl)return null;// If it's already an 11-character ID, return it\nif(videoIdOrUrl.length===11&&/^[a-zA-Z0-9_-]{11}$/.test(videoIdOrUrl)){return videoIdOrUrl;}// Try to extract from YouTube URL\nconst patterns=[/(?:youtube\\.com\\/watch\\?v=|youtu\\.be\\/|youtube\\.com\\/embed\\/)([a-zA-Z0-9_-]{11})/,/youtube\\.com\\/.*[?&]v=([a-zA-Z0-9_-]{11})/];for(const pattern of patterns){const match=videoIdOrUrl.match(pattern);if(match&&match[1]){return match[1];}}return null;};const VideoPlayer=_ref=>{let{videoId,videoUrl,onVideoEnd,courseId,videoDbId,onProgressUpdate,onVideoStart}=_ref;const iframeRef=useRef(null);const progressIntervalRef=useRef(null);const lastProgressTimeRef=useRef(0);// Use videoUrl if provided, otherwise use videoId\nconst source=videoUrl||videoId;const extractedId=extractVideoId(source);useEffect(()=>{// Listen for YouTube player events\nconst handleMessage=event=>{if(event.origin!=='https://www.youtube.com')return;try{const data=JSON.parse(event.data);if(data.event==='onStateChange'){// 0 = ended, 1 = playing, 2 = paused\nif(data.info===0&&onVideoEnd){onVideoEnd();}// Start tracking when video starts playing\nif(data.info===1&&onVideoStart){onVideoStart();}}}catch(e){// Ignore parse errors\n}};window.addEventListener('message',handleMessage);return()=>window.removeEventListener('message',handleMessage);},[onVideoEnd,onVideoStart]);if(!extractedId){return/*#__PURE__*/_jsxs(\"div\",{className:\"video-player-error\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"Invalid video URL. Please check the video link.\"}),source&&/*#__PURE__*/_jsxs(\"p\",{style:{fontSize:'0.9rem',marginTop:'0.5rem',color:'#666'},children:[\"Original URL: \",source]})]});}return/*#__PURE__*/_jsx(\"div\",{className:\"video-player-wrapper\",children:/*#__PURE__*/_jsx(\"div\",{className:\"video-player-container\",children:/*#__PURE__*/_jsx(\"iframe\",{ref:iframeRef,className:\"video-iframe\",src:\"https://www.youtube.com/embed/\".concat(extractedId,\"?rel=0&modestbranding=1&enablejsapi=1&origin=\").concat(window.location.origin),title:\"YouTube video player\",frameBorder:\"0\",allow:\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\",allowFullScreen:true})})});};export default VideoPlayer;","map":{"version":3,"names":["React","useEffect","useRef","jsx","_jsx","jsxs","_jsxs","extractVideoId","videoIdOrUrl","length","test","patterns","pattern","match","VideoPlayer","_ref","videoId","videoUrl","onVideoEnd","courseId","videoDbId","onProgressUpdate","onVideoStart","iframeRef","progressIntervalRef","lastProgressTimeRef","source","extractedId","handleMessage","event","origin","data","JSON","parse","info","e","window","addEventListener","removeEventListener","className","children","style","fontSize","marginTop","color","ref","src","concat","location","title","frameBorder","allow","allowFullScreen"],"sources":["/Users/chaitra/Desktop/EduTrack/frontend/src/components/VideoPlayer.js"],"sourcesContent":["import React, { useEffect, useRef } from 'react';\nimport './VideoPlayer.css';\n\n// Extract YouTube video ID from various URL formats\nconst extractVideoId = (videoIdOrUrl) => {\n    if (!videoIdOrUrl) return null;\n    \n    // If it's already an 11-character ID, return it\n    if (videoIdOrUrl.length === 11 && /^[a-zA-Z0-9_-]{11}$/.test(videoIdOrUrl)) {\n        return videoIdOrUrl;\n    }\n    \n    // Try to extract from YouTube URL\n    const patterns = [\n        /(?:youtube\\.com\\/watch\\?v=|youtu\\.be\\/|youtube\\.com\\/embed\\/)([a-zA-Z0-9_-]{11})/,\n        /youtube\\.com\\/.*[?&]v=([a-zA-Z0-9_-]{11})/,\n    ];\n    \n    for (const pattern of patterns) {\n        const match = videoIdOrUrl.match(pattern);\n        if (match && match[1]) {\n            return match[1];\n        }\n    }\n    \n    return null;\n};\n\nconst VideoPlayer = ({ videoId, videoUrl, onVideoEnd, courseId, videoDbId, onProgressUpdate, onVideoStart }) => {\n    const iframeRef = useRef(null);\n    const progressIntervalRef = useRef(null);\n    const lastProgressTimeRef = useRef(0);\n    \n    // Use videoUrl if provided, otherwise use videoId\n    const source = videoUrl || videoId;\n    const extractedId = extractVideoId(source);\n    \n    useEffect(() => {\n        // Listen for YouTube player events\n        const handleMessage = (event) => {\n            if (event.origin !== 'https://www.youtube.com') return;\n            \n            try {\n                const data = JSON.parse(event.data);\n                if (data.event === 'onStateChange') {\n                    // 0 = ended, 1 = playing, 2 = paused\n                    if (data.info === 0 && onVideoEnd) {\n                        onVideoEnd();\n                    }\n                    // Start tracking when video starts playing\n                    if (data.info === 1 && onVideoStart) {\n                        onVideoStart();\n                    }\n                }\n            } catch (e) {\n                // Ignore parse errors\n            }\n        };\n        \n        window.addEventListener('message', handleMessage);\n        return () => window.removeEventListener('message', handleMessage);\n    }, [onVideoEnd, onVideoStart]);\n    \n    if (!extractedId) {\n        return (\n            <div className=\"video-player-error\">\n                <p>Invalid video URL. Please check the video link.</p>\n                {source && (\n                    <p style={{ fontSize: '0.9rem', marginTop: '0.5rem', color: '#666' }}>\n                        Original URL: {source}\n                    </p>\n                )}\n            </div>\n        );\n    }\n\n    return (\n        <div className=\"video-player-wrapper\">\n            <div className=\"video-player-container\">\n                <iframe\n                    ref={iframeRef}\n                    className=\"video-iframe\"\n                    src={`https://www.youtube.com/embed/${extractedId}?rel=0&modestbranding=1&enablejsapi=1&origin=${window.location.origin}`}\n                    title=\"YouTube video player\"\n                    frameBorder=\"0\"\n                    allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\"\n                    allowFullScreen\n                ></iframe>\n            </div>\n        </div>\n    );\n};\n\nexport default VideoPlayer;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}